{"ts":1355661700201,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"from bs4 import BeautifulSoup\nimport urllib\n\ndef convertstring(str):\n\tstr = str.replace(u\"\\xe4\", \"ae\")\n\tstr = str.replace(u\"\\xc4\", \"Ae\")\n\tstr = str.replace(u\"\\xf6\", \"oe\")\n\tstr = str.replace(u\"\\xd6\", \"Oe\")\n\tstr = str.replace(u\"\\xfc\", \"ue\")\n\tstr = str.replace(u\"\\xdc\", \"Ue\")\n\tstr = str.replace(u\"\\xdf\", \"ss\")\n\treturn str\n\nlink = 'http://vorlesungsplan.dhbw-mannheim.de/index.php?action=view&gid=3067001&uid=3865001&date=1346623200'\nical = open(\"tai10abc.ics\", \"w\")\n#uncomment to use a proxy\n#proxies = {'http': 'http://PROXY_URL:PROXY_PORT'}\nical.write(\"BEGIN:VCALENDAR\\n\")\nical.write(\"METHOD:PUBLISH\\n\")\nical.write(\"PRODID:-//crzy//iCal 3.0//EN\\n\")\nical.write(\"CALSCALE:GREGORIAN\\n\")\nical.write(\"X-WR-CALNAME:TAI10ABC\\n\")\nical.write(\"X-WR-TIMEZONE:Europe/Berlin\\n\")\nical.write(\"VERSION:2.0\\n\")\nical.write(\"BEGIN:VTIMEZONE\\n\")\nical.write(\"TZID:Europe/Berlin\\n\")\nical.write(\"BEGIN:DAYLIGHT\\n\")\nical.write(\"TZOFFSETFROM:+0100\\n\")\nical.write(\"TZOFFSETTO:+0200\\n\")\nical.write(\"DTSTART:19810329T020000\\n\")\nical.write(\"RRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=-1SU\\n\")\nical.write(\"TZNAME:CEST\\n\")\nical.write(\"END:DAYLIGHT\\n\")\nical.write(\"BEGIN:STANDARD\\n\")\nical.write(\"TZOFFSETFROM:+0200\\n\")\nical.write(\"TZOFFSETTO:+0100\\n\")\nical.write(\"DTSTART:19961027T030000\\n\")\nical.write(\"RRULE:FREQ=YEARLY;BYMONTH=10;BYDAY=-1SU\\n\")\nical.write(\"TZNAME:CET\\n\")\nical.write(\"END:STANDARD\\n\")\nical.write(\"END:VTIMEZONE\\n\")\n\nfor weeks in range(12):\n\t#html = urllib.urlopen(link, proxies=proxies)\n\thtml = urllib.urlopen(link)\n\tsoup = BeautifulSoup(html)\n\tweekdays = soup.find_all('ul')\n\n\tfor weekday in weekdays:\n\t\tmonth = weekday.li.text[-2:]\n\t\tday = weekday.li.text[-5:]\n\t\tday = day[:2]\n\t\tdate = \"2012%s%s\" % (month, day)\n\t\tfor appointment in weekday.find_all('li'):\n\t\t\tif len(appointment)>1:\n\t\t\t\tical.write(\"BEGIN:VEVENT\\n\")\n\t\t\t\tproperties = appointment.find_all('div')\n\t\t\t\tstarttime = properties[0].text[:2] + properties[0].text[:5][-2:]\n\t\t\t\tendtime = properties[0].text[:8][-2:] + properties[0].text[:11][-2:]\n\t\t\t\tdescription = properties[1].text\n\t\t\t\tdescription = convertstring(description)\n\n\t\t\t\tif len(properties)>2:\n\t\t\t\t\tlocation = properties[2].text\t\t\n\t\t\t\t\tlocation = convertstring(location)\t\n\t\t\t\telse:\n\t\t\t\t\tlocation = \"\"\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\tical.write(\"LOCATION:%s\\n\" % (location))\t\t\t\t\n\t\t\t\tical.write(\"SUMMARY:%s\\n\" % (description))\n\t\t\t\tical.write(\"DESCRIPTION:%s\\n\" % (description))\n\t\t\t\tical.write(\"DTSTART;TZID=Europe/Berlin:%s\\n\" % (date + \"T\" + starttime + \"00\"))\n\t\t\t\tical.write(\"DTEND;TZID=Europe/Berlin:%s\\n\" % (date + \"T\" + endtime + \"00\"))\n\t\t\t\tical.write(\"END:VEVENT\\n\")\n\t\t\t\t\n\tlink = 'http://vorlesungsplan.dhbw-mannheim.de/' + soup.find_all('a')[1].get('href')\n\nical.write(\"END:VCALENDAR\\n\")\t\t\t\nical.close()"]],"start1":0,"start2":0,"length1":0,"length2":2688}]],"length":2688}
{"contributors":[],"silentsave":true,"ts":1356100170276,"patch":[[{"diffs":[[0,"n range("],[-1,"12"],[1,"48"],[0,"):\n\t#htm"]],"start1":1404,"start2":1404,"length1":18,"length2":18}]],"length":2688,"saved":false}
{"ts":1356100220658,"patch":[[{"diffs":[[0,"nge("],[-1,"48"],[1,"50"],[0,"):\n\t"]],"start1":1408,"start2":1408,"length1":10,"length2":10}]],"length":2688,"saved":false}
